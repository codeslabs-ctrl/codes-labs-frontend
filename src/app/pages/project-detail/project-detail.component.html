<!-- Header Navigation -->
<nav class="bg-gradient-to-r from-cyan-50/90 via-cyan-100/90 to-cyan-50/90 dark:from-slate-900/95 dark:via-slate-800/95 dark:to-slate-900/95 backdrop-blur-md border-b border-cyan-200/50 dark:border-cyan-800/50 sticky top-0 z-50 shadow-lg shadow-cyan-500/10">
  <div class="max-w-7xl mx-auto px-6 py-4">
    <div class="flex items-center justify-between">
      <a routerLink="/" class="flex items-center space-x-4 group cursor-pointer">
        <div class="relative">
          <div class="absolute inset-0 bg-cyan-400/20 rounded-xl blur-lg group-hover:bg-cyan-400/30 transition-all duration-300"></div>
          <img
            src="assets/logo.webp"
            alt="Codes-Labs Logo"
            class="h-14 w-auto relative z-10 transition-transform duration-300 group-hover:scale-105"
          />
        </div>
        <span class="text-3xl font-bold bg-gradient-to-r from-cyan-600 to-cyan-500 dark:from-cyan-400 dark:to-cyan-300 bg-clip-text text-transparent group-hover:from-cyan-700 group-hover:to-cyan-600 dark:group-hover:from-cyan-300 dark:group-hover:to-cyan-200 transition-all duration-300">
          Codes-Labs
        </span>
      </a>
      <div class="hidden md:flex items-center space-x-6">
        <a routerLink="/" class="text-cyan-700 dark:text-cyan-300 hover:text-cyan-800 dark:hover:text-cyan-200 font-medium transition-colors">Inicio</a>
        <a routerLink="/" fragment="proyectos" class="text-cyan-700 dark:text-cyan-300 hover:text-cyan-800 dark:hover:text-cyan-200 font-medium transition-colors">Proyectos</a>
        <a routerLink="/" fragment="identidad" class="text-cyan-700 dark:text-cyan-300 hover:text-cyan-800 dark:hover:text-cyan-200 font-medium transition-colors">Nosotros</a>
        <a routerLink="/contacto" class="text-cyan-700 dark:text-cyan-300 hover:text-cyan-800 dark:hover:text-cyan-200 font-medium transition-colors">Contacto</a>
      </div>
    </div>
  </div>
</nav>

<!-- Project Detail Content -->
<div class="min-h-screen bg-background">
  @if (isLoading) {
    <div class="flex justify-center items-center py-20">
      <div class="text-center space-y-4">
        <lucide-icon name="loader-2" class="h-12 w-12 text-cyan-500 animate-spin mx-auto"></lucide-icon>
        <p class="text-muted-foreground">Cargando proyecto...</p>
      </div>
    </div>
  } @else if (error) {
    <div class="max-w-4xl mx-auto px-6 py-20">
      <div class="bg-red-500/20 border border-red-500/50 rounded-lg p-6 text-center">
        <lucide-icon name="alert-circle" class="h-12 w-12 text-red-500 mx-auto mb-4"></lucide-icon>
        <p class="text-red-300 font-semibold text-lg mb-4">{{ error }}</p>
        <app-button routerLink="/" [variant]="'default'">
          Volver al Inicio
        </app-button>
      </div>
    </div>
  } @else if (project) {
    <div class="max-w-7xl mx-auto px-6 py-12">
      <!-- Back Button -->
      <div class="mb-8">
        <app-button routerLink="/" [variant]="'ghost'" size="sm">
          <lucide-icon name="arrow-left" class="mr-2 h-4 w-4"></lucide-icon>
          Volver a Proyectos
        </app-button>
      </div>

      <!-- Project Header -->
      <div class="mb-12">
        <div class="flex items-start gap-6 mb-6">
          <div class="w-20 h-20 rounded-2xl bg-gradient-primary flex items-center justify-center shadow-glow-primary">
            <ng-container [ngSwitch]="project.iconName">
              <lucide-icon *ngSwitchCase="'bar-chart-3'" name="bar-chart-3" class="h-10 w-10 text-white"></lucide-icon>
              <lucide-icon *ngSwitchCase="'bot'" name="bot" class="h-10 w-10 text-white"></lucide-icon>
              <lucide-icon *ngSwitchCase="'rocket'" name="rocket" class="h-10 w-10 text-white"></lucide-icon>
              <lucide-icon *ngSwitchCase="'activity'" name="activity" class="h-10 w-10 text-white"></lucide-icon>
              <lucide-icon *ngSwitchCase="'briefcase-medical'" name="briefcase-medical" class="h-10 w-10 text-white"></lucide-icon>
              <lucide-icon *ngSwitchDefault name="sparkles" class="h-10 w-10 text-white"></lucide-icon>
            </ng-container>
          </div>
          <div class="flex-1">
            <div class="flex items-center gap-4 mb-2">
              <h1 class="text-4xl lg:text-5xl font-bold text-foreground">{{ project.title }}</h1>
              <app-badge [variant]="'secondary'">{{ project.category }}</app-badge>
            </div>
            <p class="text-xl text-muted-foreground">{{ project.description }}</p>
          </div>
        </div>
      </div>

      <!-- Stats Grid -->
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-12">
        @for (stat of getStats(project); track stat.key) {
          <app-card class="bg-card border-border">
            <app-card-content class="p-6 text-center">
              <p class="text-muted-foreground text-sm uppercase font-semibold mb-2">{{ stat.key }}</p>
              <p class="text-foreground font-bold text-2xl">{{ stat.value }}</p>
            </app-card-content>
          </app-card>
        }
      </div>

      <!-- Technologies Section -->
      <div class="mb-12">
        <h2 class="text-2xl font-bold text-foreground mb-6">Tecnologías Utilizadas</h2>
        @if (project.technologies && project.technologies.length > 0) {
          <div class="flex flex-wrap gap-3">
            @for (tech of project.technologies; track tech) {
              <app-badge [variant]="'outline'" class="text-base px-4 py-2">
                {{ tech }}
              </app-badge>
            }
          </div>
        } @else {
          <p class="text-muted-foreground">No hay tecnologías registradas para este proyecto.</p>
        }
      </div>

      <!-- Project Details Section -->
      @if (project.details && project.details.length > 0) {
        <div class="mb-12">
          <h2 class="text-3xl font-bold text-foreground mb-8 flex items-center gap-3">
            <lucide-icon name="file-text" class="h-8 w-8 text-cyan-500"></lucide-icon>
            Detalles del Proyecto
          </h2>
          
          <!-- Features Grid (Características principales) -->
          @if (featureDetails.length > 0) {
            <div class="mb-10">
              <h3 class="text-2xl font-semibold text-foreground mb-6 flex items-center gap-2">
                <lucide-icon name="sparkles" class="h-6 w-6 text-cyan-500"></lucide-icon>
                Características Principales
              </h3>
              <div class="grid md:grid-cols-2 gap-6">
                @for (detail of featureDetails; track detail.id) {
                  <app-card class="bg-card border-border hover:border-cyan-500/50 hover:shadow-lg transition-all duration-300 h-full">
                    <app-card-content class="p-6">
                      <div [innerHTML]="markdownToHtml(detail.projectDetail)" class="prose prose-cyan dark:prose-invert max-w-none">
                      </div>
                    </app-card-content>
                  </app-card>
                }
              </div>
            </div>
          }

          <!-- Technologies Section (Tecnologías) -->
          @if (technologyDetails.length > 0) {
            <div class="mb-10">
              <h3 class="text-2xl font-semibold text-foreground mb-6 flex items-center gap-2">
                <lucide-icon name="code" class="h-6 w-6 text-cyan-500"></lucide-icon>
                Tecnologías Utilizadas
              </h3>
              <div class="grid md:grid-cols-2 gap-6">
                @for (detail of technologyDetails; track detail.id) {
                  <app-card class="bg-gradient-to-br from-cyan-50/50 to-cyan-100/30 dark:from-cyan-950/20 dark:to-cyan-900/10 border-cyan-500/30 hover:shadow-lg transition-all duration-300">
                    <app-card-content class="p-6">
                      <div [innerHTML]="markdownToHtml(detail.projectDetail)" class="prose prose-cyan dark:prose-invert max-w-none">
                      </div>
                    </app-card-content>
                  </app-card>
                }
              </div>
            </div>
          }

          <!-- Security Section (Seguridad) -->
          @if (securityDetails.length > 0) {
            <div class="mb-10">
              <h3 class="text-2xl font-semibold text-foreground mb-6 flex items-center gap-2">
                <lucide-icon name="shield" class="h-6 w-6 text-cyan-500"></lucide-icon>
                Seguridad
              </h3>
              <div class="grid gap-6">
                @for (detail of securityDetails; track detail.id) {
                  <app-card class="bg-gradient-to-br from-slate-50 to-slate-100/50 dark:from-slate-900/30 dark:to-slate-800/20 border-slate-500/30 hover:shadow-lg transition-all duration-300">
                    <app-card-content class="p-6">
                      <div [innerHTML]="markdownToHtml(detail.projectDetail)" class="prose prose-cyan dark:prose-invert max-w-none">
                      </div>
                    </app-card-content>
                  </app-card>
                }
              </div>
            </div>
          }

          <!-- Benefits Section (Beneficios) -->
          @if (benefitDetails.length > 0) {
            <div class="mb-10">
              <h3 class="text-2xl font-semibold text-foreground mb-6 flex items-center gap-2">
                <lucide-icon name="award" class="h-6 w-6 text-cyan-500"></lucide-icon>
                Beneficios del Sistema
              </h3>
              <div class="grid gap-6">
                @for (detail of benefitDetails; track detail.id) {
                  <app-card class="bg-gradient-to-br from-green-50/50 to-emerald-100/30 dark:from-green-950/20 dark:to-emerald-900/10 border-green-500/30 hover:shadow-lg transition-all duration-300">
                    <app-card-content class="p-6">
                      <div [innerHTML]="markdownToHtml(detail.projectDetail)" class="prose prose-cyan dark:prose-invert max-w-none">
                      </div>
                    </app-card-content>
                  </app-card>
                }
              </div>
            </div>
          }

          <!-- Other Details (Otros detalles) -->
          @if (otherDetails.length > 0) {
            <div class="mb-10">
              <div class="grid md:grid-cols-2 gap-6">
                @for (detail of otherDetails; track detail.id) {
                  <app-card class="bg-card border-border hover:border-cyan-500/50 hover:shadow-lg transition-all duration-300 h-full">
                    <app-card-content class="p-6">
                      <div [innerHTML]="markdownToHtml(detail.projectDetail)" class="prose prose-cyan dark:prose-invert max-w-none">
                      </div>
                    </app-card-content>
                  </app-card>
                }
              </div>
            </div>
          }

          <!-- Fallback: Si no hay detalles organizados pero sí hay detalles, mostrarlos todos -->
          @if (featureDetails.length === 0 && technologyDetails.length === 0 && 
               securityDetails.length === 0 && benefitDetails.length === 0 && 
               otherDetails.length === 0 && project.details && project.details.length > 0) {
            <div class="mb-10">
              <div class="grid md:grid-cols-2 gap-6">
                @for (detail of project.details; track detail.id) {
                  <app-card class="bg-card border-border hover:border-cyan-500/50 hover:shadow-lg transition-all duration-300 h-full">
                    <app-card-content class="p-6">
                      <div [innerHTML]="markdownToHtml(detail.projectDetail)" class="prose prose-cyan dark:prose-invert max-w-none">
                      </div>
                    </app-card-content>
                  </app-card>
                }
              </div>
            </div>
          }
        </div>
      }

      <!-- Results Summary (if no details available, show stats) -->
      @if (!project.details || project.details.length === 0) {
        <div class="grid md:grid-cols-2 gap-8 mb-12">
          <app-card class="bg-card border-border">
            <app-card-content class="p-8">
              <h3 class="text-xl font-bold text-foreground mb-4 flex items-center gap-2">
                <lucide-icon name="target" class="h-5 w-5 text-cyan-500"></lucide-icon>
                Objetivo del Proyecto
              </h3>
              <p class="text-muted-foreground leading-relaxed">
                Este proyecto fue desarrollado con el objetivo de {{ project.description.toLowerCase() }}. 
                Utilizamos las mejores prácticas y tecnologías modernas para garantizar un rendimiento óptimo 
                y una experiencia de usuario excepcional.
              </p>
            </app-card-content>
          </app-card>

          <app-card class="bg-card border-border">
            <app-card-content class="p-8">
              <h3 class="text-xl font-bold text-foreground mb-4 flex items-center gap-2">
                <lucide-icon name="award" class="h-5 w-5 text-cyan-500"></lucide-icon>
                Resultados Alcanzados
              </h3>
              <ul class="space-y-3 text-muted-foreground">
                @for (stat of getStats(project); track stat.key) {
                  <li class="flex items-center gap-2">
                    <lucide-icon name="check-circle" class="h-4 w-4 text-cyan-500"></lucide-icon>
                    <span><strong class="text-foreground">{{ stat.key }}:</strong> {{ stat.value }}</span>
                  </li>
                }
              </ul>
            </app-card-content>
          </app-card>
        </div>
      }

      <!-- Call to Action -->
      <div class="text-center">
        <app-card class="bg-gradient-to-r from-cyan-500/10 to-cyan-600/10 border-cyan-500/20">
          <app-card-content class="p-8">
            <h3 class="text-2xl font-bold text-foreground mb-4">
              ¿Interesado en un proyecto similar?
            </h3>
            <p class="text-muted-foreground mb-6 max-w-2xl mx-auto">
              Contáctanos y descubre cómo podemos ayudarte a transformar tu idea en realidad con soluciones tecnológicas innovadoras.
            </p>
            <div class="flex gap-4 justify-center">
              <app-button routerLink="/contacto" size="lg" [variant]="'default'">
                Contactar Ahora
                <lucide-icon name="arrow-right" class="ml-2 h-4 w-4"></lucide-icon>
              </app-button>
              <app-button routerLink="/" size="lg" [variant]="'outline'">
                Ver Más Proyectos
              </app-button>
            </div>
          </app-card-content>
        </app-card>
      </div>
    </div>
  }
</div>

